# SpecDocGenerator.WPF

GUI デスクトップアプリケーション for SpecDocGenerator

## 概要

このWPFアプリケーションは、既存のCUIベースのコード解析・仕様書生成機能をGUIで操作できるようにラップしたものです。

## 機能

### メイン画面
- **対象フォルダ選択**: 解析するプログラムフォルダを選択
- **除外パターン**: 除外するフォルダをカンマ区切りで指定 (例: bin,obj,node_modules)
- **言語フィルタ**: 対象言語をカンマ区切りで指定 (空欄=全言語対応)
- **ファイルツリー**: 検出されたコードファイルの一覧表示
- **進捗表示**: 
  - フェーズ表示 (ファイルスキャン/コード解析/チャンク分割/要約生成/仕様書生成/Excel出力)
  - プログレスバー
  - 処理状況メッセージ
- **プレビュー**: 生成される仕様書の各セクションをタブで表示
  - 概要
  - 機能仕様
  - API仕様
  - データ構造
  - 依存関係
  - テスト観点
  - リスク
  - 変更履歴
- **制御ボタン**:
  - 開始: 解析を開始
  - 一時停止: 処理を一時停止 (実装予定)
  - 再開: 一時停止した処理を再開 (実装予定)
  - キャンセル: 処理をキャンセル
  - 設定: LLM設定画面を開く

### 設定画面
- **LLMプロバイダ設定**:
  - Azure OpenAI エンドポイント
  - APIキー
  - デプロイ名 (モデル名)
  - 接続テスト機能 (実装予定)
- **LLMパラメータ**:
  - Temperature (0.0 - 2.0)
  - 最大トークン数 (1000 - 8000)
- **処理設定**:
  - チャンクサイズ (1000 - 8000)
  - 並列度 (1 - 8) (実装予定)
  - 再試行回数 (0 - 5) (実装予定)
- **ログ設定**:
  - ログ保存先フォルダ

## アーキテクチャ

### MVVMパターン
- **Models**: Core プロジェクトのモデルを使用
- **ViewModels**: 
  - `MainViewModel`: メイン画面のロジック
  - `SettingsViewModel`: 設定画面のロジック
- **Views**: 
  - `MainWindow`: メイン画面
  - `SettingsWindow`: 設定画面

### 非同期処理
- `async/await` パターンによる非同期実行
- `CancellationToken` によるキャンセル対応
- プログレスレポート機能

### 使用ライブラリ
- **CommunityToolkit.Mvvm**: MVVM実装のヘルパー
- **Microsoft.Extensions.Logging**: ロギング機能
- 既存のCoreライブラリ (Analysis, LLM, Excel)

## 使用方法

### 起動
```bash
cd src/SpecDocGenerator.WPF
dotnet run
```

または、ビルド後に実行可能ファイルを直接実行:
```bash
dotnet build -c Release
./bin/Release/net8.0-windows/SpecDocGenerator.WPF.exe
```

### 基本的なワークフロー

1. **対象フォルダの選択**
   - "参照..." ボタンをクリックして、解析対象のプロジェクトフォルダを選択

2. **除外パターンの設定** (オプション)
   - 解析から除外したいフォルダを指定 (デフォルト: bin,obj,node_modules,.git,.vs)

3. **言語フィルタの設定** (オプション)
   - 特定の言語のみを対象にする場合に指定

4. **LLM設定** (オプション)
   - "設定" ボタンから Azure OpenAI の設定を行う
   - 設定しない場合は基本的な解析のみ実行

5. **解析の開始**
   - "開始 / Start" ボタンをクリック
   - 進捗バーとメッセージで進行状況を確認
   - プレビューエリアで各セクションの内容を確認

6. **完了**
   - 処理完了後、指定した出力先にExcelファイルが生成される

### Azure OpenAI 設定

設定画面で以下を入力:
- **エンドポイント**: `https://your-resource.openai.azure.com/`
- **APIキー**: Azure ポータルから取得したAPIキー
- **デプロイ名**: 使用するモデル (例: gpt-4, gpt-35-turbo)

設定は環境変数として保存されます。

## 今後の実装予定

- [ ] 一時停止/再開機能の実装
- [ ] 並列処理の実装
- [ ] リトライ機能の実装
- [ ] 接続テスト機能の実装
- [ ] ダークモード対応
- [ ] 設定の永続化 (ファイル保存)
- [ ] チェックポイント機能 (処理の再開)
- [ ] 差分解析機能
- [ ] エクスポート形式の追加 (PDF, Markdown)

## トラブルシューティング

### ビルドエラー
- .NET 8 SDK がインストールされていることを確認
- Windows でビルドする場合、`EnableWindowsTargeting` は不要

### 実行時エラー
- Azure OpenAI を使用する場合、正しいエンドポイントとAPIキーが設定されていることを確認
- ログを確認してエラーの詳細を把握

## ライセンス

MIT License
